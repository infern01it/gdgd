import React, {Component} from 'react';
import {connect} from 'react-redux';
import {Link} from 'react-router';
import R from 'ramda';


import {fetchPhones} from 'actions';
import {getPhones} from 'selectors';

class Phones extends Component {
	componentDidMount() {
		this.props.fetchPhones();
	}

	renderPhone(phone, index) {
		console.log(phone);
		const shortDescription = `${R.take(60, phone.description)}...`;
		return (
			<div
				key={index}
				className="col-sm-4">
					<div className="img">
						<img
							src={phone.image}
							alt={phone.name}
						/>
						<ul>
							<li>${phone.price}</li>
							<li>
								<Link to={`/phones/${phone.id}`}>
									{phone.name}
								</Link>
							</li>
							<li>
								<p>{shortDescription}</p>
							</li>
							<li>
								<button>
									Buy now!
								</button>
							</li>
							<li>
								<Link to={`/phones/${phone.id}`}>
									More info...
								</Link>
							</li>
						</ul>
					</div>
			</div>
		);
	}

	render() {
		const {phones} = this.props;
		return (
			<div>
				<div className="books row">
					{
						phones.map((phone, index) => {
							return this.renderPhone(phone, index);
						})
					}
				</div>
			</div>
		)
	}
}

const mapStateToProps = state => ({
	phones: getPhones(state)
});

const mapDispatchToProps = {
	fetchPhones
};

export default connect(mapStateToProps, mapDispatchToProps)(Phones);