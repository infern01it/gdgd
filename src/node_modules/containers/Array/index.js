import React, {Component, Fragment} from 'react';
import {connect} from 'react-redux';

import {getArray} from 'selectors';

import Header from 'components/Header';
import Footer from 'components/Footer';

import ArrayMain from './ArrayMain';
import ArrayProps from 'containers/Array/ArrayProps';
import ArrayContent from 'containers/Array/ArrayContent';
import ArrayMedia from 'containers/Array/ArrayMedia';
import ArrayIcons from 'containers/Array/ArrayIcons';
import ArraySlider from 'containers/Array/ArraySlider';
import ArrayPlots from 'containers/Array/ArrayPlots';


class Array extends Component {
  ready(data) {
    return typeof data === 'object';
  }
  
  render() {
    const { array } = this.props;

    return (
      <Fragment>
        <Header/>
        <main className="main page-array">
          {
            this.ready(array) && <Fragment>
              <ArrayMain 
                id={array.id}
                name={array.name}
                mainImg={array.main_img[0].url}
              />

              <ArrayProps
                area={array.area}
                price={array.price_total}
                count={array.land_plots.length}
                coords={array.coords}
                legalSystem={array.legal_system}
                confirmedRights={array.confirmed_rights}
              />

              <ArrayContent
                desc={{__html: array.description}}
                mapImg={array.map_img.length != 0 ? array.map_img[0].url : ''}
              />

              <ArrayMedia
                panoramaUrl={array.panorama_url}
                panoramaImg={array.panorama_img.length != 0 ? array.panorama_img[0].url : ''}
                videoId={array.video}
              />

              <ArrayIcons
                infrastructure={array.infrastructure}
              />

              <ArraySlider
                arrayImg={array.slider_img}
              />

              <ArrayPlots
                arrayPlots={array.land_plots}
              />
            </Fragment>
          }
          <Footer />
        </main>
      </Fragment>
    );
  }
}

const mapStateToProps = (state, ownProps) => ({
  array: getArray(state, ownProps)
});

export default connect(mapStateToProps, null)(Array);
